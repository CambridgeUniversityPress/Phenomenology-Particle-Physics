%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% P3: Phenomenology of Particle Physics                         
%%
%% Author:  Andr√© Rubbia                   		 
%%
%% Figure 2.28 Total interaction cross-section of neutrons as a function of energy (eV).  
%%
%% This work is licensed under the Creative Commons Attribution 4.0 International License. 
%% To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/ or 
%% send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.
%%
%% The data for water is computed with GEANT4. The rest of the data
%% is taken directly from the ENDF/B-VII.1 database.
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper,10pt]{article}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[labelfont=bf]{caption}
\usepackage{upgreek}
\usepackage{amssymb}
\usepackage{amsmath}

\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.17}
\usepgfplotslibrary{ternary}
\usepgfplotslibrary{fillbetween}
\usepgfplotslibrary{external}


\def\d{\mathrm{d}}

\begin{document}

%%%%%%%%%%%%%%%   FIGURE  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
\begin{loglogaxis}[
    title={Total cross-section of neutrons $A(n,TOT)$},
    xlabel={Neutron energy (eV)},
    ylabel={$\sigma_{tot}$ (barns)},
    height=0.8\textwidth,
    width=0.9\textwidth,
    xmin=1e-5, xmax=2e8,
    ymin=1e-1, ymax=1e3,
    legend pos=north east,
    ymajorgrids=true,
    xmajorgrids=true,
   grid style=dashed,
]
\addplot[
    color=blue,
    mark=square*, smooth
    ]
    coordinates {
    (0.003617,188.897)
(0.012705,130.148)
(0.11221,68.012)
(1.0194,46.626)
( 10 , 44.23455149501662 )
( 100 , 44.20166112956811 )
( 1000.0 , 44.195681063122926 )
( 10000.0 , 42.09069767441861 )
( 100000.0 , 28.971926910299004 )
( 1000000.0 , 12.897209302325582 )
( 10000000.0 , 3.15 )
( 100000000.0 , 0.8174750830564784 )
    };

\addplot[
    color=magenta, very thick
    ]
%LIBRARY    ENDF/B-VIII.0
%REACTION   H-1(N,TOT),SIG
%NUCLEUS    H-1
%EN-MIN     1e-05
%EN-MAX     2e+07
%E,eV        Sig,b        Interpolation
coordinates {
( 1E-05,       1176.39)
( 1.10304E-05, 1120.11)
( 1.21669E-05, 1066.53)
( 1.34206E-05, 1015.51)
( 1.48034E-05, 966.937)
( 1.63286E-05, 920.686)
( 1.80111E-05, 876.65 )
( 1.98669E-05, 834.721)
( 2.19139E-05, 794.8  )
( 2.41719E-05, 756.791)
( 2.66625E-05, 720.601)
( 2.94097E-05, 686.144)
( 3.244E-05,   653.337)
( 3.57825E-05, 622.101)
( 3.94694E-05, 592.362)
( 4.35362E-05, 564.046)
( 4.80221E-05, 537.087)
( 5.29701E-05, 511.42 )
( 5.8428E-05,  486.983)
( 6.44482E-05, 463.716)
( 7.10888E-05, 441.565)
( 7.84136E-05, 420.476)
( 8.64931E-05, 400.398)
( 9.54051E-05, 381.283)
(0.000105235,363.084)
(0.000116078,345.759)
(0.000128039,329.265)
(0.000141232,313.563)
(0.000155784,298.615)
(0.000171835,284.385)
(0.00018954,270.839)
(0.00020907, 257.944)
(0.000230612, 245.67 )
(0.000254374, 233.986)
(0.000280584, 222.865)
(0.000309494, 212.28 )
(0.000341383, 202.206)
(0.000376558, 192.617)
(0.000415358, 183.492)
(0.000458155, 174.808)
(0.000505362, 166.545)
(0.000557433, 158.682)
(0.000614869, 151.2  )
(0.000678223, 144.082)
(0.000748105, 137.31 )
(0.000825188, 130.869)
(0.000910213, 124.742)
(0.001004,    118.915)
(0.00110745,  113.374)
(0.00122155,  108.105)
(0.00134742,  103.096)
(0.00148625,  98.3351)
(0.00163939,  93.8103)
(0.00180831,  89.5109)
(0.00199463,  85.4481)
(0.00200871,  85.1419)
(0.00220016,  81.585 )
(0.0022312  , 81.0095)
(0.00242685,  77.9132)
(0.00247845,  77.0984)
(0.00267691,  74.4242)
(0.00275297,  73.4013)
(0.00295273,  71.1101)
(0.00305805,  69.9046)
(0.00325697,  67.9632)
(0.00339677,  66.6017)
(0.00359256,  64.9765)
(0.0037732  , 63.4804)
(0.00396272 , 62.1429)
(0.00419113 , 60.5347)
(0.00437103 , 59.4561)
(0.00465558 , 57.7538)
(0.00482141 , 56.9095)
(0.00517125 , 55.1323)
(0.00531819,  54.4973)
(0.00574431,  52.6603)
(0.00586616,  52.2138)
(0.00638057,  50.3332)
(0.00647059,  50.0536)
(0.00708766,  48.1419)
(0.0071373  , 48.0114)
(0.00787271,  46.0824)
(0.00868389,  44.2824)
(0.00874515,  44.1468)
(0.00957865,  42.5838)
(0.00971379,  42.3309)
(0.0105656  , 40.99  )
(0.0108658 ,  40.5185)
(0.0116543 ,  39.4837)
(0.0121545 ,  38.8286)
(0.0128551 ,  38.0631)
(0.013596   , 37.2554)
(0.0141796 ,  36.7253)
(0.0152085 ,  35.793 )
(0.0156406 ,  35.4672)
(0.0170122 ,  34.436 )
(0.0172522 ,  34.287 )
(0.0190298 ,  33.1864)
(0.0191641 ,  33.1034)
(0.0209906 ,  32.1795)
(0.0215871 ,  31.8785)
(0.0231534 ,  31.2326)
(0.0243176 ,  30.7538)
(0.0252419 ,  30.4211)
(0.0253   ,   30.4009)
(0.0279068,   29.5916)
(0.0286998,   29.3461)
(0.0307823,   28.8286)
(0.0325565,   28.389 )
(0.033954  ,  28.1135)
(0.037192  ,  27.4772)
(0.0374525,   27.4369)
(0.0413115,   26.8411)
(0.0424854,   26.6604)
(0.0455681,   26.2901)
(0.0488745,   25.8942)
(0.0502633,   25.7664)
(0.0554423,   25.2918)
(0.0566211,   25.1841)
(0.0611549,   24.8712)
(0.0660549,   24.5343)
(0.0674561,   24.4627)
(0.0744066,   24.1088)
(0.0776004,   23.9468)
(0.0820732,   23.7819)
(0.0905297,   23.4715)
(0.0924546,   23.4012)
(0.0998577,   23.2102)
(0.110147  ,  22.946 )
(0.111701  ,  22.9063)
(0.121496 ,   22.7344)
(0.134014 ,   22.516 )
(0.136864 ,   22.4665)
(0.147823 ,   22.3403)
(0.163054 ,   22.1659)
(0.171253 ,   22.0726)
(0.179855 ,   22.0105)
(0.198386 ,   21.8776)
(0.218827 ,   21.732 )
(0.220371 ,   21.7211)
(0.241375 ,   21.6322)
(0.266245 ,   21.5278)
(0.293678 ,   21.4134)
(0.323938 ,   21.3439)
(0.357316 ,   21.268 )
(0.394132 ,   21.185 )
(0.41105   ,  21.1471)
(0.434743 ,   21.1205)
(0.479537 ,   21.0707)
(0.528947 ,   21.0163)
(0.583448 ,   20.9569)
(0.612785 ,   20.9252)
(0.643565 ,   20.9107)
(0.709876 ,   20.8797)
(0.78302   ,  20.8461)
(0.8637     , 20.8095)
(0.952693 ,   20.7695)
(1.0076     , 20.7451)
(1.05086   ,  20.7383)
(1.15913   ,  20.7217)
(1.27857   ,  20.7037)
(1.4103     , 20.6842)
(1.55562   ,  20.663 )
(1.7159     , 20.64  )
(1.89271   ,  20.6149)
(1.96022   ,  20.6055)
(2.08772   ,  20.6011)
(2.30284   ,  20.594 )
(2.54012   ,  20.5864)
(2.80184   ,  20.5784)
(3.09053   ,  20.5697)
(3.40897   ,  20.5603)
(3.76022   ,  20.5502)
(4.14767   ,  20.5393)
(4.57503   ,  20.5275)
(5.04642   ,  20.5146)
(5.33729   ,  20.5067)
(5.56639   ,  20.506 )
(6.13994   ,  20.5042)
(6.77258   ,  20.5024)
(7.4704     , 20.5005)
(8.24013   ,  20.4986)
(9.08917   ,  20.4967)
(10.0257   ,  20.4947)
(11.0587   ,  20.4926)
(12.2842   ,  20.4903)
(13.5499   ,  20.488 )
(14.9461   ,  20.4856)
(16.6016   ,  20.4828)
(18.3121   ,  20.48  )
(20.199     , 20.4771)
(22.2802   ,  20.474 )
(24.7492   ,  20.4703)
(27.1081   ,  20.4669)
(30.1122   ,  20.4627)
(33.4475   ,  20.458 )
(36.8938   ,  20.4533)
(40.6952   ,  20.4482)
(43.3445   ,  20.4446)
(44.8884   ,  20.4443)
(49.5135   ,  20.4433)
(55.0005   ,  20.4423)
(60.6676   ,  20.4412)
(66.9186   ,  20.4401)
(73.8137   ,  20.4389)
(81.4192   ,  20.4377)
(89.8084   ,  20.4364)
(99.7559   ,  20.4348)
(110.811    , 20.4332)
(121.372   ,  20.4316)
(132.947   ,  20.43  )
(145.618   ,  20.4282)
(158.387   ,  20.4264)
(173.492   ,  20.4244)
(190.027   ,  20.4221)
(206.691   ,  20.4199)
(226.402   ,  20.4173)
(246.256   ,  20.4146)
(267.85     , 20.4118)
(291.338   ,  20.4088)
(314.667   ,  20.4057)
(344.675   ,  20.4019)
(377.526   ,  20.3976)
(410.632   ,  20.3934)
(449.791   ,  20.3884)
(492.661   ,  20.3829)
(535.863   ,  20.3775)
(578.799   ,  20.372 )
(642.909   ,  20.3639)
(694.423   ,  20.3574)
(750.027   ,  20.3504)
(833.143   ,  20.34  )
(906.203   ,  20.3308)
(985.669   ,  20.3208)
(1072.1     , 20.31  )
(1157.95   ,  20.2992)
(1277.26   ,  20.2842)
(1369.94   ,  20.2726)
(1500.58   ,  20.2563)
(1666.79   ,  20.2355)
(1800.35   ,  20.2188)
(1958.22   ,  20.1991)
(2144.86   ,  20.1758)
(2349.4     , 20.1502)
(2519.88   ,  20.1289)
(2760.05   ,  20.099 )
(3044.43   ,  20.0635)
(3358.12   ,  20.0243)
(3627.19   ,  19.9907)
(3917.63   ,  19.9545)
(4291.23   ,  19.9079)
(4667.54   ,  19.861 )
(5112.4     , 19.8055)
(5560.72   ,  19.7496)
(6133.68   ,  19.6781)
(6625.14   ,  19.6168)
(7155.64   ,  19.5507)
(7838.03   ,  19.4656)
(8585.08   ,  19.3725)
(9403.79   ,  19.2704)
(10086.1   ,  19.1853)
(10372.7    , 19.1496)
(12016.2     ,18.971 )
(14117.2   ,  18.7428)
(16105.4   ,  18.5267)
(18127      , 18.3071)
(19716.6   ,  18.1344)
(20134.8   ,  18.0943)
(22209.4   ,  17.8954)
(24327.4   ,  17.6924)
(26460.7   ,  17.4879)
(28380.7   ,  17.3038)
(30226.7   ,  17.1268)
(35262.9   ,  16.7007)
(38355.2   ,  16.4391)
(40282.2   ,  16.2902)
(45375.2   ,  15.8966)
(47658.6   ,  15.7202)
(50352.7   ,  15.5335)
(55388      , 15.1847)
(57765.5  ,   15.02  )
(60667     ,  14.8393)
(65458.5  ,   14.5409)
(67318.5  ,   14.4251)
(70700     ,  14.2366)
(75829.9  ,   13.9507)
(81128.7  ,   13.6554)
(81700.9  ,   13.6235)
(86410.1  ,   13.3959)
(91269.7  ,   13.1611)
(97019.9  ,   12.8833)
(97335.2  ,   12.8681)
(101411   ,   12.6954)
(110776   ,   12.2987)
(113126   ,   12.1991)
(120490   ,   11.9249)
(130000   ,   11.5708)
(130917   ,   11.5412)
(141400   ,   11.203 )
(145418   ,   11.0733)
(151660   ,   10.8901)
(161129   ,   10.6121)
(163402   ,   10.5454)
(171199   ,   10.3449)
(182335   ,   10.0585)
(183827   ,   10.0201)
(192681   ,   9.81951)
(201411   ,   9.62167)
(204252   ,   9.55728)
(221552   ,   9.20899)
(224678   ,   9.14606)
(240980   ,   8.85344)
(246092   ,   8.76168)
(261834   ,   8.50823)
(267388   ,   8.41882)
(281975   ,   8.20843)
(292019   ,   8.06358)
(302116   ,   7.93436)
(322257   ,   7.67661)
(344797   ,   7.42552)
(354594   ,   7.31637)
(364670   ,   7.22006)
(388080   ,   6.99629)
(402822   ,   6.85537)
(411366   ,   6.78617)
(443104   ,   6.52911)
(446208   ,   6.50397)
(469780   ,   6.33788)
(493639   ,   6.16978)
(503527   ,   6.11114)
(553880   ,   5.81249)
(557760   ,   5.78947)
(608465   ,   5.5306 )
(663820   ,   5.28304)
(714883   ,   5.08011)
(719891   ,   5.06235)
(771312   ,   4.88004)
(800000   ,   4.78928)
(834340   ,   4.68065)
(918107   ,   4.44855)
(925574   ,   4.43041)
(1E+06     ,  4.24954)
(1.07256E+06,4.09901)
(1.11552E+06,4.0099 )
(1.21693E+06,3.82663)
(1.32764E+06,3.65109)
(1.42977E+06,3.50678)
(1.54262E+06,3.36395)
(1.66868E+06,3.2209 )
(1.83827E+06,3.05136)
(1.85115E+06,3.03998)
(2E+06,      2.90842)
(2.08585E+06,2.84298)
(2.23104E+06,2.7323 )
(2.35963E+06,2.64615)
(2.43386E+06,2.59642)
(2.6E+06,    2.49724)
(2.63668E+06,2.47534)
(2.85953E+06,2.35652)
(3.06379E+06,2.25804)
(3.08525E+06,2.24865)
(3.29093E+06,2.15867)
(3.54594E+06,2.05749)
(3.72841E+06,1.99301)
(3.8808E+06, 1.93916)
(4.2E+06,    1.83825)
(4.63245E+06,1.71847)
(5.07054E+06,1.61201)
(5.47618E+06,1.52413)
(5.88183E+06,1.44512)
(6.21402E+06,1.38657)
(6.28747E+06,1.37362)
(6.69311E+06,1.30858)
(7.09876E+06,1.24926)
(7.24969E+06,1.22916)
(7.60581E+06,1.18172)
(8.11287E+06,1.12069)
(8.61992E+06,1.06525)
(8.74153E+06,1.05312)
(9.12697E+06,1.01467)
(9.63403E+06,0.968334)
(1E+07,      0.936908)
(1.01411E+07,0.925726)
(1.02842E+07,0.914388)
(1.04292E+07,0.902891)
(1.05E+07,   0.897284)
(1.05764E+07,0.891681)
(1.06481E+07,0.886419)
(1.07256E+07,0.880737)
(1.07984E+07,0.8754 )
(1.08769E+07,0.869638)
(1.09507E+07,0.864226)
(1.1E+07,    0.860611)
(1.10304E+07,0.858543)
(1.11552E+07,0.850046)
(1.1186E+07, 0.847949)
(1.13126E+07,0.839332)
(1.13438E+07,0.837206)
(1.14722E+07,0.828467)
(1.15E+07,   0.826572)
(1.15038E+07,0.826329)
(1.16622E+07,0.816294)
(1.16661E+07,0.816048)
(1.18268E+07,0.805872)
(1.18307E+07,0.805621)
(1.19936E+07,0.795302)
(1.19976E+07,0.795048)
(1.2E+07,    0.794899)
(1.21669E+07,0.785037)
(1.21693E+07,0.784896)
(1.23386E+07,0.774895)
(1.2341E+07, 0.774751)
(1.25E+07,   0.765356)
(1.26764E+07,0.755615)
(1.28552E+07,0.745737)
(1.3E+07,    0.737739)
(1.30366E+07,0.735848)
(1.31834E+07,0.72825)
(1.32205E+07,0.726332)
(1.33694E+07,0.718627)
(1.3407E+07, 0.716682)
(1.35E+07,   0.71187)
(1.35961E+07,0.707202)
(1.36905E+07,0.702622)
(1.3788E+07, 0.697888)
(1.38836E+07,0.693244)
(1.39825E+07,0.688442)
(1.4E+07,    0.687592)
(1.41798E+07,0.679624)
(1.41975E+07,0.678837)
(1.43798E+07,0.670756)
(1.43978E+07,0.669958)
(1.45827E+07,0.661764)
(1.46009E+07,0.660954)
(1.47884E+07,0.652644)
(1.48069E+07,0.651823)
(1.4997E+07, 0.643396)
(1.5E+07,    0.643265)
(1.52086E+07,0.635036)
(1.52116E+07,0.634918)
(1.54232E+07,0.626573)
(1.54262E+07,0.626453)
(1.56408E+07,0.61799)
(1.56439E+07,0.617869)
(1.58615E+07,0.609286)
(1.58646E+07,0.609163)
(1.6E+07,    0.603821)
(1.60852E+07,0.600812)
(1.62257E+07,0.595851)
(1.63122E+07,0.592799)
(1.64546E+07,0.587768)
(1.65423E+07,0.584673)
(1.66868E+07,0.579571)
(1.67757E+07,0.576433)
(1.69222E+07,0.571259)
(1.7E+07,    0.568512)
(1.70124E+07,0.56812)
(1.72398E+07,0.56089)
(1.72524E+07,0.560492)
(1.74831E+07,0.553161)
(1.74958E+07,0.552757)
(1.77297E+07,0.545322)
(1.77426E+07,0.544912)
(1.79799E+07,0.537373)
(1.79929E+07,0.536958)
(1.8E+07,    0.536733)
(1.82468E+07,0.529639)
(1.82539E+07,0.529433)
(1.85042E+07,0.522239)
(1.85115E+07,0.52203)
(1.87653E+07,0.514735)
(1.87726E+07,0.514523)
(1.9E+07,    0.507987)
(1.92681E+07,0.500986)
(1.95399E+07,0.493886)
(1.98156E+07,0.486685)
(2E+07,      0.481868)
};


\addplot[
    color=cyan, very thick, dashed
    ]
%#LIBRARY    ENDF/B-VIII.0
%#REACTION   O-16(N,TOT),SIG
%#NUCLEUS    O-16
%#EN-MIN     1e-05
%#EN-MAX     1.5e+08
%#E,eV        Sig,b        Interpolation
    table [x=e, y=sig]
{cross-section_n_O_small.dat};

\addplot[
    color=brown, very thick, densely dotted
    ]
%#LIBRARY    ENDF/B-VIII.0
%#REACTION   SI-28(N,TOT),SIG
%#NUCLEUS    Si-28
%#EN-MIN     1e-05
%#EN-MAX     1.5e+08
%#E,eV        Sig,b        Interpolation
    table [x=e, y=sig]
{cross-section_n_Si_small.dat};

     \legend{$\mathrm{H_2O}$,H,$^{16}$O,$^{28}$Si}
\end{loglogaxis}
\end{tikzpicture}
\caption{Total interaction cross-section of neutrons as a function of energy (eV).}
\end{center}
\end{figure}
%%%%%%%%%%%%%%%   END FIGURE  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
